# -*-python-*-

%lexer

\s+ %restart

[0-9]+ INT
[0-9]+.[0-9]+(e-?[0-9]+) FLOAT

%parser

%left "+" "-"
%left "*" "/"
%right "^"
%right UNARY

expr:
    "(" expr ")": $$.sem = $2.sem
    INT: $$.sem = int($1.sem)
    FLOAT: $$.sem = float($1.sem)
    "-" expr %prec(UNARY): $$.sem = -$2.sem
    expr "+" expr: $$.sem = $1.sem + $3.sem
    expr "-" expr: $$.sem = $1.sem - $3.sem
    expr "*" expr: $$.sem = $1.sem * $3.sem
    expr "^" expr: $$.sem = $1.sem ** $3.sem
    expr "/" expr:
        if isinstance($3.sem, int) and isinstance($1.sem, int):
            $$.sem = $1.sem // $3.sem
        else:
            $$.sem = $1.sem / $3.sem
